<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Minha Sequência</title>
  <link rel="stylesheet" href="css/estilo-sequencia.css" />
</head>
<body>
  <div class="container">
    <!-- Rotinas -->
    <aside class="rotinas">
      <h3>ROTINAS</h3>
      <div class="item" draggable="true">
        <img src="img/acordar.png" alt="Acordar" />
        <div class="rotina-label">Acordar</div>
      </div>
      <div class="item" draggable="true">
        <img src="img/tomar-banho.png" alt="Tomar banho" />
        <div class="rotina-label">Tomar banho</div>
      </div>
      <div class="item" draggable="true">
        <img src="img/escovar-dentes.png" alt="Escovar os dentes" />
        <div class="rotina-label">Escovar os dentes</div>
      </div>
      <div class="item" draggable="true">
        <img src="img/colocar-roupa.png" alt="Colocar a roupa" />
        <div class="rotina-label">Colocar a roupa</div>
      </div>
      <div class="item" draggable="true">
        <img src="img/tomar-cafe.png" alt="Tomar café" />
        <div class="rotina-label">Tomar café</div>
      </div>
      <div class="item" draggable="true">
        <img src="img/psicologo.png" alt="Psicólogo" />
        <div class="rotina-label">Psicólogo</div>
      </div>
      <div class="item" draggable="true">
        <img src="img/psicopedagoga.png" alt="Psicopedagoga" />
        <div class="rotina-label">Psicopedagoga</div>
      </div>
    </aside>

    <!-- Conteúdo -->
    <main class="conteudo">
      <section class="sequencia">
        <h2>MINHA SEQUÊNCIA</h2>
        <div id="data-dia" class="data-dia"></div>
        <div id="area-sequencia" class="area-sequencia" ondragover="event.preventDefault()" ondrop="soltar(event)"></div>
        <button onclick="salvarSequencia()">Salvar Sequência</button>
        <br />
        <h3><a href="rotinas-salvas.html" class="link-titulo">MINHAS SEQUÊNCIAS RECENTES</a></h3>
        <div id="lista-recente"></div>
        <br />
        <button onclick="desfazerUltimo()">Desfazer Último</button>
      </section>
    </main>
  </div>

  <script>
    const imagens = {
      "Acordar": "acordar.png",
      "Tomar banho": "tomar-banho.png",
      "Escovar os dentes": "escovar-dentes.png",
      "Colocar a roupa": "colocar-roupa.png",
      "Tomar café": "tomar-cafe.png",
      "Psicólogo": "psicologo.png",
      "Psicopedagoga": "psicopedagoga.png"
    };

    let itensAdicionados = []; // <- Aqui armazenamos os cards

    document.addEventListener("DOMContentLoaded", () => {
      const hoje = new Date().toLocaleDateString("pt-BR", {
        day: "2-digit", month: "short", year: "numeric"
      });
      document.getElementById("data-dia").innerText = `DIA ${hoje.toUpperCase()}`;
      carregarSequenciasAnteriores();

      document.querySelectorAll(".item").forEach(el => {
        el.addEventListener("dragstart", e => {
          const nome = e.target.querySelector(".rotina-label").innerText;
            e.dataTransfer.setData("text/plain", nome);
        });
      });
    });

    function soltar(e) {
      e.preventDefault();

      // Recupera o nome da rotina a partir do elemento arrastado
      const nome = e.dataTransfer.getData("text/plain");
      if (!nome) return;

      // Clona o item a partir do nome da rotina
      const novoItem = document.createElement("div");
      novoItem.className = "item";
      novoItem.setAttribute("draggable", "false");
      novoItem.innerHTML = `
      <img src="img/${imagens[nome]}" alt="${nome}" />
      <div class="rotina-label">${nome}</div>
  `;

  document.getElementById("area-sequencia").appendChild(novoItem);
  itensAdicionados.push(novoItem); // Para desfazer depois
}


    function desfazerUltimo() {
      if (itensAdicionados.length > 0) {
        const ultimo = itensAdicionados.pop();
        ultimo.remove();
      } else {
        alert("Nenhum item para desfazer.");
      }
    }

    function salvarSequencia() {
      const hoje = new Date().toISOString().split("T")[0];
      const elementos = document.querySelectorAll("#area-sequencia .item .rotina-label");
      const sequencia = Array.from(elementos).map(el => el.innerText);
      const json = JSON.stringify(sequencia);
      localStorage.setItem(`sequencia-${hoje}`, json);
      alert("Sequência salva com sucesso!");
      carregarSequenciasAnteriores();
    }

    function carregarSequenciasAnteriores() {
      // Essa função está aqui como placeholder, se quiser incluir a lista de dias salvos no futuro
    }

    function carregarSequenciasRecentes() {
    const lista = document.getElementById("lista-recente");
    lista.innerHTML = "";

    Object.keys(localStorage).forEach(key => {
      if (key.startsWith("sequencia-")) {
        const data = key.replace("sequencia-", "");
        const btn = document.createElement("button");
        btn.innerText = `Dia ${data}`;
        btn.className = "btn-rotina";
        btn.onclick = () => {
          const json = localStorage.getItem(key);
          const sequencia = JSON.parse(json);
          localStorage.setItem("sequencia-hoje", JSON.stringify(sequencia));
          window.location.reload(); // Atualiza a página com a nova sequência
        };
        lista.appendChild(btn);
      }
    });
  }
  // Chama ao carregar a página
  document.addEventListener("DOMContentLoaded", carregarSequenciasRecentes);
  </script>

<footer style="text-align: center; padding: 20px; font-size: 14px; color: #3c73a8;">
  Desenvolvido por Vitória Ferreira 2025
</footer>
</body>
</html>





